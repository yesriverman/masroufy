{% extends 'base.html' %}
{% block title %}ğŸ“‚ Ø§Ù„ØªØ³Ù…ÙŠØ§Øª Ø§Ù„ÙØ±Ø¹ÙŠØ© Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ø§Ù„Ù…ØªØºÙŠØ±Ø©{% endblock %}
{% block content %}

<div class="container mt-4">
  <div class="accordion" id="groupAccordion">
    {% for group in groups %}
      <div class="accordion-item mb-3">
        <h2 class="accordion-header" id="heading{{ group.id }}">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#collapse{{ group.id }}" aria-expanded="false" aria-controls="collapse{{ group.id }}">
            ğŸ—‚ï¸ {{ group.name }}
          </button>
        </h2>

        <div id="collapse{{ group.id }}" class="accordion-collapse collapse" aria-labelledby="heading{{ group.id }}"
             data-bs-parent="#groupAccordion">
          <div class="accordion-body">

            {% with group.labels.all|dictsort:"order" as labels %}
              {% if labels %}
                <div class="accordion" id="labelAccordion{{ group.id }}">
                  {% for sub in labels %}
                    <div class="accordion-item mb-2">
                      <h2 class="accordion-header" id="labelHeading{{ sub.id }}">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#labelCollapse{{ sub.id }}" aria-expanded="false"
                                aria-controls="labelCollapse{{ sub.id }}">
                          ğŸ·ï¸ {{ sub.name }} â€” ğŸ’° {{ sub.expected_monthly|floatformat:2 }} Ø¯.Ù…
                        </button>
                      </h2>
                      <div id="labelCollapse{{ sub.id }}" class="accordion-collapse collapse"
                           aria-labelledby="labelHeading{{ sub.id }}" data-bs-parent="#labelAccordion{{ group.id }}">
                        <div class="accordion-body d-flex flex-wrap justify-content-end gap-2">
                          <a href="{% url 'label_edit' sub.id %}?next={{ request.path }}" class="btn btn-sm btn-outline-warning">âœï¸ ØªØ¹Ø¯ÙŠÙ„</a>
                          <a href="{% url 'label_delete' sub.id %}?next={{ request.path }}" class="btn btn-sm btn-outline-danger">ğŸ—‘ï¸ Ø­Ø°Ù</a>
                          <a href="{% url 'move_label_up' sub.pk %}?next={{ request.path }}" class="btn btn-sm btn-outline-secondary">â¬†ï¸</a>
                          <a href="{% url 'move_label_down' sub.pk %}?next={{ request.path }}" class="btn btn-sm btn-outline-secondary">â¬‡ï¸</a>
                        </div>
                      </div>
                    </div>
                  {% endfor %}
                </div>
              {% else %}
                <p class="text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ³Ù…ÙŠØ§Øª ÙØ±Ø¹ÙŠØ© Ø¶Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©.</p>
              {% endif %}
            {% endwith %}

            <div class="d-flex justify-content-between mt-3">
              <a href="{% url 'label_add' %}?group={{ group.id }}&next={{ request.path }}" class="btn btn-sm btn-primary">â• Ø¥Ø¶Ø§ÙØ© ØªØ³Ù…ÙŠØ©</a>
              <div class="d-flex gap-2">
                <a href="{% url 'group_edit' group.id %}?next={{ request.path }}" class="btn btn-sm btn-warning">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©</a>
                <a href="{% url 'group_delete' group.id %}?next={{ request.path }}" class="btn btn-sm btn-danger">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©</a>
              </div>
            </div>

          </div>
        </div>
      </div>
    {% endfor %}
  </div>

  <div class="d-flex justify-content-between mt-4 flex-wrap">
    <a href="{% url 'group_add' %}?next={{ request.path }}" class="btn btn-success">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø¬Ù…ÙˆØ¹Ø©</a>
    <a href="{% url 'label_add' %}?next={{ request.path }}" class="btn btn-primary">â• Ø¥Ø¶Ø§ÙØ© ØªØ³Ù…ÙŠØ© Ø¹Ø§Ù…Ø©</a>
  </div>
</div>

{% endblock %}


